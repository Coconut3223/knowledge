
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../highd/">
      
      
        <link rel="next" href="../nb/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.24">
    
    
      
        <title>LinearRegreesion - Coconut3223</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/markdown-it-admonition.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="LinearRegreesion - Coconut3223" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="./assets/images/social/AI/ML/lr.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="None" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="LinearRegreesion - Coconut3223" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="./assets/images/social/AI/ML/lr.png" >
      
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lrs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Coconut3223" class="md-header__button md-logo" aria-label="Coconut3223" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Coconut3223
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              LinearRegreesion
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../python/" class="md-tabs__link">
          
  
    
  
  python

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  AI

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../NLP/" class="md-tabs__link">
          
  
    
  
  NLP

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../CV/" class="md-tabs__link">
          
  
    
  
  CV

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../SQL/" class="md-tabs__link">
          
  
    
  
  SQL

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../utils/" class="md-tabs__link">
          
  
    
  
  Utils

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../math/" class="md-tabs__link">
          
  
    
  
  Math

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Temp/" class="md-tabs__link">
          
  
    
  
  Temp

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Coconut3223" class="md-nav__button md-logo" aria-label="Coconut3223" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Coconut3223
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../python/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    python
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/python_elegant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elegant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/enhanced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    enhanced
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/numpy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    numpy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/exam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    八股文
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/pytorch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytorch
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    AI
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pre/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pre-processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../loss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eva/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../highd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High-dimensional Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" checked>
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ML
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            ML
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    LinearRegreesion
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    LinearRegreesion
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-setting" class="md-nav__link">
    <span class="md-ellipsis">
      Problem Setting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-regression" class="md-nav__link">
    <span class="md-ellipsis">
      Linear Regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linear Regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphical" class="md-nav__link">
    <span class="md-ellipsis">
      Graphical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inference-of-lr-model" class="md-nav__link">
    <span class="md-ellipsis">
      inference of LR model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="inference of LR model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confidence-interval-for-the-regression-function" class="md-nav__link">
    <span class="md-ellipsis">
      Confidence interval for the regression function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      广义线性模型
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regularization" class="md-nav__link">
    <span class="md-ellipsis">
      正则化 Regularization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="正则化 Regularization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ridge-regression-l2-penalty" class="md-nav__link">
    <span class="md-ellipsis">
      Ridge Regression - L2 penalty
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ridge Regression - L2 penalty">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content" class="md-nav__link">
    <span class="md-ellipsis">
      Content
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Content">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-shrinkage-parameter-ridge" class="md-nav__link">
    <span class="md-ellipsis">
      λ := the shrinkage parameter - ridge
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lasso-l1-penalty-least-absolute-shrinkage-and-selection-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Lasso - L1 penalty, Least Absolute Shrinkage and Selection Operator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lasso - L1 penalty, Least Absolute Shrinkage and Selection Operator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-shrinkage-parameter-lasso" class="md-nav__link">
    <span class="md-ellipsis">
      λ := the shrinkage parameter -lasso
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elastic-net-a-combination-of-lasso-and-ridge-regression" class="md-nav__link">
    <span class="md-ellipsis">
      elastic net: A combination of Lasso and Ridge regression
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comparison">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lse-lasso-ridge" class="md-nav__link">
    <span class="md-ellipsis">
      LSE &amp; Lasso &amp; ridge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lasso-ridge" class="md-nav__link">
    <span class="md-ellipsis">
      Lasso &amp; ridge
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution-path" class="md-nav__link">
    <span class="md-ellipsis">
      solution path
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NaiveBayes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logistics Regression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../svm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../knn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decision Tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ensemble_learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ensemble Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../association_analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Association Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clustering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clustering
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../DL/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    DL
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            DL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DL/cnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DL/mlp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MLP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DL/rnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DL/transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DL/generative_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generative Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DL/transferlearning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transfer Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DL/tricks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tricks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DL/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../NLP/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    NLP
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            NLP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Embedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/subword/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subword
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/kea/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keyword Extraction Algorithm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/nmt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neural Machine Translation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/gpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/opennmt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openNMT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/huggingface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HuggingFace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/asr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ASR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/survey_on_synthesizing_training_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Synthesizing Training Data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../CV/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    CV
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CV
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../SQL/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    SQL
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../SQL/exam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    八股文
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/hadoop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hadoop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/mapreduce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Map Reduce
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/vscode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VScode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/html_css/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML CSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/PPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PPT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Math
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Math
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Temp/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Temp
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Temp
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-setting" class="md-nav__link">
    <span class="md-ellipsis">
      Problem Setting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-regression" class="md-nav__link">
    <span class="md-ellipsis">
      Linear Regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linear Regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphical" class="md-nav__link">
    <span class="md-ellipsis">
      Graphical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inference-of-lr-model" class="md-nav__link">
    <span class="md-ellipsis">
      inference of LR model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="inference of LR model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confidence-interval-for-the-regression-function" class="md-nav__link">
    <span class="md-ellipsis">
      Confidence interval for the regression function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      广义线性模型
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regularization" class="md-nav__link">
    <span class="md-ellipsis">
      正则化 Regularization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="正则化 Regularization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ridge-regression-l2-penalty" class="md-nav__link">
    <span class="md-ellipsis">
      Ridge Regression - L2 penalty
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ridge Regression - L2 penalty">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content" class="md-nav__link">
    <span class="md-ellipsis">
      Content
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Content">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-shrinkage-parameter-ridge" class="md-nav__link">
    <span class="md-ellipsis">
      λ := the shrinkage parameter - ridge
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lasso-l1-penalty-least-absolute-shrinkage-and-selection-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Lasso - L1 penalty, Least Absolute Shrinkage and Selection Operator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lasso - L1 penalty, Least Absolute Shrinkage and Selection Operator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-shrinkage-parameter-lasso" class="md-nav__link">
    <span class="md-ellipsis">
      λ := the shrinkage parameter -lasso
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elastic-net-a-combination-of-lasso-and-ridge-regression" class="md-nav__link">
    <span class="md-ellipsis">
      elastic net: A combination of Lasso and Ridge regression
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comparison">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lse-lasso-ridge" class="md-nav__link">
    <span class="md-ellipsis">
      LSE &amp; Lasso &amp; ridge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lasso-ridge" class="md-nav__link">
    <span class="md-ellipsis">
      Lasso &amp; ridge
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution-path" class="md-nav__link">
    <span class="md-ellipsis">
      solution path
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="lrs">LRs<a class="headerlink" href="#lrs" title="Permanent link">&para;</a></h1>
<p><mark>多重回归</mark>.包含了多个变量的回归</p>
<h2 id="problem-setting">Problem Setting<a class="headerlink" href="#problem-setting" title="Permanent link">&para;</a></h2>
<div class="arithmatex">\[y =β_0 +β_1x_1 +...+β_px_p +ε=\red{\beta^Tx}+\epsilon\\\quad\begin{cases}x_1,\dots,x_p:&amp;\text{Predictors, }\red{\text{independent}}\text{ variable, covariates}\\Y:&amp;\text{Response, dependent variable
}\\\epsilon:&amp;\text{noises, error}\end{cases}\]</div>
<div class="arithmatex">\[\begin{cases}Y_1=\beta_0+\beta_1x_{1,1}+\dots+\beta_{p}x_{1,p}+\epsilon_1\\Y_2=\beta_0+\beta_1x_{2,1}+\dots+\beta_{p}x_{2,p}+\epsilon_2\\\vdots\\Y_n=\beta_0+\beta_1x_{n,1}+\dots+\beta_{p}x_{n,p}+\epsilon_n\end{cases}\\\iff\begin{bmatrix}Y_1\\\vdots\\Y_n\end{bmatrix}=\begin{bmatrix}1&amp;x_{1,1}&amp;\dots&amp;x_{1,p}\\\vdots\\1&amp;x_{n,1}&amp;\dots&amp;x_{n,p}\end{bmatrix}\begin{bmatrix}\beta_0\\\beta_1\\\vdots\\\beta_p\end{bmatrix}+\begin{bmatrix}\epsilon_1\\\vdots\\\epsilon_n\end{bmatrix}\\=\begin{bmatrix}x_1^T&amp;\dots&amp; x_n^T\\\end{bmatrix}\beta+\Xi,x_i=\begin{bmatrix}1\\x_{i1}\\\vdots\\x_{ip}\end{bmatrix},\beta=\begin{bmatrix}\beta_0\\\beta_1\\\vdots\\\beta_p\end{bmatrix},\Xi=\begin{bmatrix}\epsilon_1\\\vdots\\\epsilon_n\end{bmatrix}\]</div>
<div class="arithmatex">\[\iff Y=\red{X\beta}+\Xi,Y\in\R^n,X\in\R^{n\times(p+1)},\beta\in\R^{p+1},\Xi\in\R^n\]</div>
<p><strong>Assumptions</strong> (for statistical inference)</p>
<ul>
<li><strong>predictor <span class="arithmatex">\(x_i\)</span> is usually assumed to be non-random.</strong>
已经被观察到了，所以是一个值，"the independent variable is an observed value (so its value is known)"，我们研究的是对一个已知的x，y的条件分布 Y｜X</li>
<li>
<p>关于误差的 assumption：</p>
<ul>
<li><span class="arithmatex">\(\red{ε_1,\dots,\epsilon_n}\)</span> <strong>are independent</strong></li>
<li><span class="arithmatex">\(\red{Eε_1 =Eε_2 =...=Eε_n =0\iff E\Xi\in\R^n=0}\)</span><ul>
<li>the model has to be identifiable.
如果没有这个假设，那么不同的模型之间只是存在一个常数 C 级别上的不同，并没有本质区别，但是在在讨论的时候就容易存在差异，感觉有点像是规定了规定，才能更好的基于统一背景下讨论。</li>
</ul>
</li>
<li><span class="arithmatex">\(\red{Var(ε_1)=...=Var(ε_n)=σ^2\iff Var(\Xi)=\sigma^2I\in\R^n}\)</span>
这个是不一定的，在heterogeneous数据里，这个没怎么听懂</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">期望和方差做 assumption 不等同于 指定分布 <span class="arithmatex">\(\mathbb{E}(\epsilon)=0 + Var(\epsilon)=\sigma^2\neq\epsilon ~Ν(0,\sigma)\)</span></p>
<p>有些书是assume <span class="arithmatex">\(ε_1,ε_2,..ε_n\in~N(0, σ), i.i.d\)</span>,是否指定分布取决于我们想干什么
线性回归残差满足正态分布只是一种假设，目的是使得后续对估计量的推断 inference 能够利用正态分布的性质。？因为在满足正态假设的前提下，hypothesis testing &amp;confidential interval 比较容易
做OLS并得出回归系数的无偏估计这一过程本身而言，并不需要分布假设，也就是说，即使Y的取值为 0、1（binary），我们仍然可以做OLS线性回归，得出回归系数的无偏估计，但此时，残差显然不服从正态分布，因此也就不能对回归系数做 wald test。</p>
</div>
<ul>
<li><span class="arithmatex">\(\red{\text{centered X}\in\R^{n\times(p+1)}, \mathbb{E}x=0,Var(X)=\Sigma\in\R^{(p+1)\times (p+1)}}\)</span></li>
<li><span class="arithmatex">\(\red{\mathbb{E}Y =0}\)</span></li>
</ul>
</li>
</ul>
<div class="arithmatex">\[β^∗ =\min_\beta \frac{1}{2}\red{\mathbb{E}}(Y − x^Tβ)^2, \colorbox{aqua}{\text{(Convex in β)}}\]</div>
<p><strong>常规思路：</strong>
<span class="arithmatex">\(\cfrac{\partial}{\partial\beta}f(\beta)=\mathbb{E}\big(x(Y-x^T\beta)\big)\xlongequal{SET}0\\[1em]\implies \beta^*=\mathbb{E}(x^Tx)^{-1}\mathbb{E}(xY)=\Sigma^{-1}Cov(x,Y)=Var(x)^{-1}Cov(x,Y)\)</span></p>
<h2 id="linear-regression">Linear Regression<a class="headerlink" href="#linear-regression" title="Permanent link">&para;</a></h2>
<div class="arithmatex">\[y = w^Tx+b\]</div>
<div class="admonition p">
<p class="admonition-title">estimate parameter using <mark>Least Squares Estimation, LSE</mark></p>
</div>
<div class="arithmatex">\[
\begin{align*}\hat{\beta}_{LSE}&amp;=\min\limits_{\beta}\sum\limits_{i=1}^n(Y_i-\hat{Y_i})^2\\&amp;=\min\limits_\beta\sum\limits_{i=1}^n\{Y_i-(\beta_0+\beta_1x_{i1}+\dots+\beta_px_{ip})\}^2\\
&amp;\xlongequal{X(\text{population level})}\min\limits_\beta\sum\limits_{i=1}^n\{Y_i-X_i^T\beta\}^2\\
&amp;\xlongequal{\mathbb X(\text{empirical level})}\min\limits_\beta(Y-\mathbb X\beta)^T(Y-\mathbb X\beta)\end{align*}\\Y\in\R^n,\mathbb X\in\R^{n\times(p+1)},\beta\in\R^{p+1}
\]</div>
<div class="arithmatex">\[
\cfrac{\partial}{\partial\beta}(Y-\mathbb X\beta)^T(Y-\mathbb X\beta)=\mathbb X^T(Y-\mathbb X\beta)\xlongequal{SET}0\\[1em]\hat{\beta}_{LSE}=(\mathbb X^T\mathbb X)^{-1}\mathbb X^TY
\]</div>
<div class="admonition p">
<p class="admonition-title">如果 <span class="arithmatex">\(\mathbb X\)</span> 有被 centered，那么用 LSE 对参数进行估计，<strong>本质上其实也是对样本方差 variance 和 correlation between features and response 的估计，这又回归到在高维空间里去. estimate is difficult</strong></p>
<div class="arithmatex">\[\hat{\beta}_{LSE}=(\mathbb X^T\mathbb X)^{-1}\mathbb X^TY=(\cfrac{\mathbb X^T\mathbb X}{n})^{-1}\cdot \cfrac{\mathbb X^T Y}{n}=Var(\mathbb X)\cdot Cov(\mathbb X, Y)\]</div>
</div>
<p><strong>requirements:</strong></p>
<ul>
<li>X必须列满秩，<span class="arithmatex">\(r(X)=p+1,n≥p+1\)</span>
<span class="arithmatex">\(r(\mathbb X)=r(\mathbb X^T\mathbb X)=p+1 \iff (\mathbb X^T\mathbb X)^{-1} \text{exists}\)</span></li>
</ul>
<p><strong>properties:</strong></p>
<ul>
<li><span class="arithmatex">\(\hat{\beta}_{LSE}\)</span> is unbiased <span class="arithmatex">\(\mathbb E(\hat\beta_{LSE})=\beta\)</span></li>
<li><span class="arithmatex">\(Var(\hat\beta_{LSE})=\sigma^2(\mathbb X^T\mathbb X)^{-1}\)</span></li>
<li><span class="arithmatex">\(\hat{Y}\)</span>  is a linear function of Y.  <span class="arithmatex">\(\iff \hat{Y}_{LSE}=X\hat{\beta}_{LSE}=X(X^TX)^{-1}X^TY\)</span>.
从这角度来卡，LR 就是使用了所有的observations</li>
<li><mark>residual sum of squares, RSS</mark> <span class="arithmatex">\(=\sum\limits_{i=1}^n\{Y_i-\hat{Y}_i\}^2\)</span> RSS表示拟合模型后Y的变化仍然不能被X的变化解释的部分 <span class="arithmatex">\(\hat{\sigma}^2=\cfrac{RSS}{n-p-1}\)</span></li>
</ul>
<h3 id="graphical">Graphical<a class="headerlink" href="#graphical" title="Permanent link">&para;</a></h3>
<p>Suppose <span class="arithmatex">\(\mathbb{X}^T\mathbb{X}\)</span> is <strong>inverible</strong>.
<span class="arithmatex">\(\hat{Y}=\mathbb{X}\hat{\beta}\implies\)</span> <span class="arithmatex">\(\hat{Y}\)</span> is an <mark>orthogonal projection image</mark> of <span class="arithmatex">\(\hat{Y}\)</span> on the image of <span class="arithmatex">\(\mathbb{X}\)</span>.<br />
<span class="arithmatex">\(\hat{\epsilon}=Y-\hat{Y}\)</span></p>
<h3 id="inference-of-lr-model">inference of LR model<a class="headerlink" href="#inference-of-lr-model" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">更强的 assumption: <span class="arithmatex">\(\Xi～N(0,\sigma^2I)(\text{i.e. correct model got})\)</span></p>
<p>指定了 <span class="arithmatex">\(\Xi\)</span> 的分布，我们才能在此基础上推 distribution of <span class="arithmatex">\(\hat\beta_{LSE}\)</span> , 才能进行 hypothesis testing. 以下由此进行推断：</p>
</div>
<p>这里存在一点狭义：这里的 <span class="arithmatex">\(\beta\)</span> 是从包括1，也就是<span class="arithmatex">\(\beta\in\R^{p+1}\)</span>, 为了更对称和完整，就直接用对应的分量 k对k来看，也就是说 <span class="arithmatex">\(\hat\beta_0～N(1, c_{0,0}\sigma^2)\)</span>, start form 0.</p>
<div class="arithmatex">\[
\begin{align*}&amp;\hat{\beta}_{LSE}～N(\beta,(\mathbb X^T\mathbb X)^{-1}\sigma^2)&amp;\tag{vector}\\&amp;\hat\beta_k～N(\beta_k,c_{k,k}\sigma^2)&amp;\tag{分量}\\&amp;\hat\beta_k-\beta_k～N(0, c_{k,k}\sigma^2)\end{align*}
\]</div>
<p><span class="arithmatex">\(\qquad\begin{cases}c_{k, k}:=\text{ the  (k,k) entry of } (\mathbb X^T \mathbb X)^{-1}\\\sqrt{c_{k,k}\hat{\sigma}^2}:=\text{ the standard error of }\beta_k\\t_k=\cfrac{\hat{\beta_k}}{\sqrt{c_{k,k}\hat{\sigma}^2}}:=\text{ the t-statistic for } \beta_k\\P(|T|&gt;|t_k|):=\text{ the p-value for }\beta_k,T～t(n-p-1)（自由度）\end{cases}\)</span></p>
<ul>
<li><span class="arithmatex">\(\Xi～N(0,\sigma^2I)(\text{i.e. correct model got})\implies \hat{\beta}～N(\beta,c_{k+1,k+1}\sigma^1)\)</span></li>
</ul>
<blockquote>
<p>At significant level 0.05 (when n is large), <span class="arithmatex">\(H_0=\beta_k=0\)</span></p>
</blockquote>
<p><a class="glightbox" href="../pics/LRs_1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_1.png" width="60%" /></a></p>
<h4 id="confidence-interval-for-the-regression-function">Confidence interval for the regression function<a class="headerlink" href="#confidence-interval-for-the-regression-function" title="Permanent link">&para;</a></h4>
<p><strong>【Uncentralized】</strong> For a subject with predictor <span class="arithmatex">\(X = (1, x_1, ..., x_p)^T\)</span>and response Y. fitted linear regression model <span class="arithmatex">\(Y= β_0 +β_1x_1 +...+β_px_p+ ε\)</span>. the regression <span class="arithmatex">\(\mathbb{E}Y=β_0 +β_1x_1 +...+β_px_p\)</span> is a function of <span class="arithmatex">\(X=(1,x_1,\dots,x_p)^T\)</span></p>
<p>The estimator of <span class="arithmatex">\(\mathbb{E}Y\)</span> is <span class="arithmatex">\(\mathbb{E}\hat{Y}=\hat β_0+\hat β_1x_1+...+\hat β_px_p=\mathbb X^T\hat β\)</span></p>
<div class="arithmatex">\[
\mathbb{E}Y～N\Big(\mathbb{E}\hat{Y},\sigma^2\mathbb X^T(\mathbb X^T\mathbb X)^{-1}\mathbb X\Big)
\]</div>
<p>The 95% confidence interval (CI) for EY is
<span class="arithmatex">\(\Big[\mathbb{E}\hat{Y}-1.96\sigma\sqrt{ X^T(\mathbb X^T\mathbb X)^{-1} X}, \mathbb{E}\hat{Y}+1.96\sigma\sqrt{X^T(\mathbb X^T\mathbb X)^{-1}X}\Big]\)</span>
or approximately
<span class="arithmatex">\(\Big[\mathbb{E}\hat{Y}-1.96\hat\sigma\sqrt{ X^T(\mathbb X^T\mathbb X)^{-1}X}, \mathbb{E}\hat{Y}+1.96\hat\sigma\sqrt{ X^T(\mathbb X^T\mathbb X)^{-1} X}\Big]\)</span></p>
<p><strong>【Centralized】</strong> For general p ≥ 1, If x and Y are both centralized，<span class="arithmatex">\(\tilde x=x-\overline x, \tilde Y=Y-\overline Y\)</span></p>
<ul>
<li><span class="arithmatex">\(\implies\beta_0=0\implies \tilde X=(\tilde x_1,\dots,\tilde x_p)\in\R^p\)</span></li>
</ul>
<p>fitted linear regression model <span class="arithmatex">\(\tilde Y = β_1\tilde x_1 +...+β_p\tilde x_p+ \tilde ε\)</span></p>
<p>the regression <span class="arithmatex">\(\mathbb{E}(\tilde Y)=β_1\tilde x_1 +...+β_p\tilde x_p\)</span> is a function of <span class="arithmatex">\(\tilde X=(\tilde x_1,\dots,\tilde x_p)^T\)</span></p>
<p>The 95% confidence interval (CI) for EY is</p>
<p><span class="arithmatex">\(\Big[\mathbb{E}\hat{\tilde{Y}}-1.96\tilde\sigma\sqrt{\tilde {X}^T(\tilde {\mathbb X}^T\tilde {\mathbb X})^{-1}\tilde {X}}, \mathbb{E}\hat{\tilde{Y}}+1.96\tilde\sigma\sqrt{\tilde X^T(\tilde {\mathbb X}^T\tilde {\mathbb X})^{-1}\tilde { X}}\Big]\)</span></p>
<p>To see the contribution of each predictor on <span class="arithmatex">\(\tilde Y\)</span> , we can fix all the other variables at 0.
For example, the contribution of <span class="arithmatex">\(\tilde x_1\xrightarrow{SET}\hat{\tilde Y}=\beta_1\tilde x_1+\beta_2\times0+\dots+\beta_p\times 0\)</span>
The 95% confidence interval (CI) for <span class="arithmatex">\(E\tilde Y\)</span> is
<span class="arithmatex">\(\Big[\widehat{E\tilde Y}-1.96\tilde\sigma\sqrt{\tilde {\chi}^T(\tilde {\mathbb X}^T\tilde {\mathbb X})^{-1}\tilde {\chi}}, \space \widehat{E\tilde Y}+1.96\tilde\sigma\sqrt{\tilde \chi^T(\tilde {\mathbb X}^T\tilde {\mathbb X})^{-1}\tilde { \chi}}\Big],\chi=(\tilde x_1,0,\dots,0)^T\)</span></p>
<p>Equivalence between hypothesis testing <span class="arithmatex">\(H_0 : β_k = 0”\)</span> and the band: After the data is centralized, we accept <span class="arithmatex">\(H_0\iff\)</span>
<span class="arithmatex">\(<span class="arithmatex">\(0\in\Big[\hat{\beta}_k-1.96\hat{\sigma}\sqrt{c_{kk}}, \hat{\beta}_k+1.96\hat{\sigma}\sqrt{c_{kk}}\Big]\)</span>\)</span></p>
<div class="arithmatex">\[\iff0\in\Big[\widehat{E\tilde Y}-1.96\tilde\sigma\sqrt{\tilde {\chi}^T(\tilde {\mathbb X}^T\tilde {\mathbb X})^{-1}\tilde {\chi}}, \space \widehat{E\tilde Y}+1.96\tilde\sigma\sqrt{\tilde \chi^T(\tilde {\mathbb X}^T\tilde {\mathbb X})^{-1}tilde { \chi}}\Big]\]</div>
<p>where <span class="arithmatex">\(\chi=(0,\dots,1,\dots,0)^T\)</span>. the kth element is 1 and the others 0.
This means 0 is included in the band at <span class="arithmatex">\(x_k=1\)</span>. On the other hand, (0,0) is included in the band. Therefore, <span class="arithmatex">\(H_0\)</span> is accepted if and only if a horizontal line is included in the band.</p>
<p><mark>the confidence band</mark></p>
<p><strong>All the predicted expectations of Y and the bounds of the CI</strong> are functions of x.
We can draw these functions and get the confidence band. 就是所有的置信区间值都画出来</p>
<div class="admonition warning">
<p class="admonition-title">不同于 conformal prediction interval（这个是囊括百分之九十五的数据点）,  confidence band 是说预测的数据 fitted value 有百分之九十五的可能被囊括</p>
</div>
<div class="grid">
<figure><a class="glightbox" href="../pics/LRs_2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_2.png" width="80%" /></a><p>uncentralized<br><span class="arithmatex">\(\hat{EY}=\hat\beta_0+\hat\beta_1x\)</span></p></figure>
<figure><a class="glightbox" href="../pics/LRs_3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_3.png" width="80%" /></a><p>centralized<br><span class="arithmatex">\(\hat{EY}=\hat\beta_0+\hat\beta_1x\)</span></p></figure>
</div>
<p><a class="glightbox" href="../pics/LRs_4.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_4.png" width="80%" /></a></p>
<p><mark>causal inference 因果推断</mark>.是在一个较大系统内部确定指定现象的实际、独立效果的过程。因果推断和相关性推断的主要区别是前者分析结果变量在其原因变量变化时发生的回应。</p>
<p><mark>干扰因素 (Confounding)</mark>. 又称为干扰因子、干扰变量、混淆变量、共变因等，在统计学和因果关系中是指会同时影响自变量和因变量，导致出现伪关系的一种变量。在不严谨的语境下，干扰因子也可以指所有未知变量，包括中介变因和对撞变因。干扰因子会造成伪关系，是相关不蕴涵因果的原因之一。
<a href="https://www.zhihu.com/question/489283459">Implementing Causal Inference: Trying to Understand the Question of Why</a>
<a href="https://stats.stackexchange.com/questions/462173/what-does-the-assumption-the-independent-variable-is-not-random-in-ols-mean">What does the assumption: "The independent variable is not random." in OLS mean?</a></p>
<div class="admonition p">
<p class="admonition-title">Assumption: both X and Y are centralized and standardized(scaled) (接下来都是基于这个设定来统一一下)</p>
</div>
<h2 id="_1">广义线性模型<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><mark>generalized linear model 广义线性模型</mark>。<span class="arithmatex">\(g(*):=\)</span>联系函数 link function
<span class="arithmatex">\(<span class="arithmatex">\(y=g^{-1}(w^Tx+b)\)</span>\)</span></p>
<blockquote>
<p>当 y 不是线性变化，而是在指数尺度上变化
<span class="arithmatex">\(\ln y=w^Tx+b\Leftrightarrow g(*)=\ln(*)\)</span>
将指数曲线投影到一条直线上。</p>
</blockquote>
<h2 id="regularization">正则化 Regularization<a class="headerlink" href="#regularization" title="Permanent link">&para;</a></h2>
<p><mark><span class="arithmatex">\(L_p\)</span> - Norm</mark>。 <span class="arithmatex">\(\Vert w\Vert_p=(\sum\limits_{i=1}^dx_i^p)^{1/p}\)</span></p>
<div class="admonition warning">
<p class="admonition-title">针对的是 row</p>
</div>
<p>避免过拟合的产生和减少网络误差
正则化的作用是选择<strong>经验风险与模型复杂度同时较小</strong>的模型。</p>
<h3 id="ridge-regression-l2-penalty">Ridge Regression  - L2 penalty<a class="headerlink" href="#ridge-regression-l2-penalty" title="Permanent link">&para;</a></h3>
<h4 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h4>
<p><strong>Why we need Ridge Regression ↔ Understanding of Ridge Regression?</strong></p>
<p><mark>the estimator <span class="arithmatex">\(\hat{\beta}\)</span> of LSE</mark> <span class="arithmatex">\(\hat\beta_{LSE}= (\mathbb X^T\mathbb X)^{-1}\mathbb X^T\mathbb Y\)</span> exists only if <span class="arithmatex">\((\mathbb X^T\mathbb X)^{-1}\)</span>
exists.
However, <span class="arithmatex">\(\hat\beta_{LSE}\)</span>  does not exist <span class="arithmatex">\(\iff (\mathbb X^T\mathbb X)\)</span> is not invertible:</p>
<ol>
<li><span class="arithmatex">\(\mathbb X\in\R^{n\times p}, p&gt;n\)</span></li>
<li>the columns in <span class="arithmatex">\(\mathbb X\)</span> are linearly dependent.</li>
</ol>
<p><u><strong>idea 1: guarantee the invertibility</strong></u>
A simple way to <strong>guarantee the invertibility</strong> is to add <strong>a diagonal matrix <span class="arithmatex">\(I\in\R^{p\times p}\)</span></strong> to <span class="arithmatex">\(\mathbb X^T\mathbb X\)</span>。 (加单位矩阵 λI 这个不止用在 linear regression)
<span class="arithmatex">\(\implies\hat\beta_{\text{ridge}}= (\mathbb X^T\mathbb X+\lambda I)^{-1}\mathbb X^T\mathbb Y,\quad \lambda&gt;0\)</span>
这也能避免一个问题就是当 eigenvalue is too small 0.00001 的时候， inverse 就会变超大 100000，导致说这个 more in-stable，在类似 using Newton Method 需要顾及 variance inverse 的时候 converge more slowly。我加一个 small lambda = 0.01，整个就会 around 在100左右</p>
<p><u><strong>idea 2: regularize the coefficients</strong></u>
<strong>FOR:</strong> If the βs are unconstrained, they can explode and are susceptible to very high variance. 爆炸，容易受到非常高的方差影响 Thus, we need to regularize the coefficients.</p>
<p><strong>approach 1: penalize the value of beta:</strong>
Using penalty approach
<mark>L2- Norm</mark>. <span class="arithmatex">\(\Vert w\Vert_2=(\sum\limits_{i=1}^dx_i^2)^{1/2}=\sqrt{w^2}\)</span>
<span class="arithmatex">\(\beta^*(\lambda):=\min\limits_\beta\sum\limits_{i=1}^n(Y_i-X_i^T\beta)^2+\lambda(\beta_1^2+\dots+\beta_p^2),\quad\lambda&gt;0\)</span>
<span class="arithmatex">\(\iff \beta^*(\lambda):=\min\limits_\beta \Vert\mathbb Y-\mathbb X\beta\Vert^2+\lambda\Vert\beta\Vert^2,\quad\lambda&gt;0\)</span>
<span class="arithmatex">\(\implies\hat\beta_{\text{ridge}}= (\mathbb X^T\mathbb X+\lambda I)^{-1}\mathbb X^T\mathbb Y,\quad \lambda&gt;0\)</span></p>
<ol>
<li>if <span class="arithmatex">\(λ → ∞ \implies \hatβ^*(λ) → 0;\)</span></li>
<li>if <span class="arithmatex">\(λ = 0\implies\hat \beta^*(λ) =\hat β_{LSE} ;\)</span></li>
</ol>
<p><strong>approach 2: constrain the value of beta:</strong>
<span class="arithmatex">\(\beta^*[t]:= \min\limits_{\beta}\sum\limits_{i=1}^n (Y_i-X_i^T\beta)^2,\quad s.t.\space\sum\limits_{j=1}^p\beta_j^2\le t \iff \text{ L2 norm}\)</span>
<span class="arithmatex">\(\iff \beta^*[t]:=\min\limits_\beta \Vert\mathbb Y-\mathbb X\beta\Vert^2,\quad s.t.\space\Vert\beta\Vert^2\le t\)</span></p>
<ol>
<li>if <span class="arithmatex">\(t = 0\implies \hat β^*[t] = 0\)</span>;</li>
<li>if <span class="arithmatex">\(t ≥ \Vert\hat β_{LSE} \Vert^2 = t_0 \implies\hatβ^* [t] = \hatβ_{LSE};\)</span></li>
</ol>
<p><strong>The Penalty approach and the Constraint approach are equivalent and t and λ have a kind of inverse relationship.</strong> <span class="arithmatex">\(t=\Vert\hat\beta^*(\lambda)\Vert^2\implies\beta^*(λ)=\beta^*[λ]\)</span></p>
<p><strong>approach 3: Data augmentation approach:</strong>
<span class="arithmatex">\(\beta^*(\lambda):=\min\limits_\beta\sum\limits_{i=1}^n(Y_i-X_i^T\beta)^2+\lambda(\beta_1^2+\dots+\beta_p^2),\quad\lambda&gt;0\)</span>
Rewrite it:
<span class="arithmatex">\(\min\limits_\beta\sum\limits_{i=1}^n(Y_i-X_i^T\beta)^2+(0-\tilde X_{n+1}^T\beta)^2+\dots+(0-\tilde X_{n+p}^T\beta)^2=\Vert  \tilde{ \mathbb Y}-\tilde{\mathbb X}\beta\Vert^2\\[1ex]\qquad\tilde X_{n+1}=(\sqrt\lambda,0,\dots,0)^T,\dots,\tilde X_{n+p}=(0,\dots,0,\sqrt\lambda)^T\)</span></p>
<p><span class="arithmatex">\(\tilde{\mathbb X}=\begin{bmatrix}x_{1,1},&amp;x_{1,2}&amp;\dots&amp;x_{1,p}\\x_{2,1},&amp;x_{2,2}&amp;\dots&amp;x_{2,p}\\\vdots\\x_{n,1},&amp;x_{n,2}&amp;\dots&amp;x_{n,p}\\\sqrt\lambda&amp;0&amp;\dots&amp;0\\0&amp;\sqrt\lambda&amp;\dots&amp;0\\\vdots&amp;&amp;\ddots\\0&amp;0&amp;\dots&amp;\sqrt\lambda\end{bmatrix}_{(n+p)\times p}=\begin{bmatrix}\mathbb X\\\sqrt\lambda I_p\end{bmatrix},\tilde{\mathbb Y}= \begin{bmatrix}Y_1\\\vdots\\Y_n\\0\\\vdots\\0\end{bmatrix}_{(n+p)}= \begin{bmatrix}\mathbb Y\\0_p\end{bmatrix}\)</span>
<span class="arithmatex">\(\implies \hat{\tilde\beta}_{LSE}=(\tilde{\mathbb X}^T\tilde{\mathbb X})^{-1}\tilde{\mathbb X}^T\tilde{\mathbb Y}\\[1ex]\qquad\qquad=(\begin{bmatrix}\mathbb X^T&amp;\sqrt\lambda I_p\end{bmatrix}\times\begin{bmatrix}\mathbb X\\\sqrt\lambda I_p\end{bmatrix})^{-1}\begin{bmatrix}\mathbb X^T&amp;\sqrt\lambda I_p\end{bmatrix}\begin{bmatrix}\mathbb Y\\\sqrt\lambda 0_p\end{bmatrix}\\[1ex]\qquad\qquad=(\mathbb X^T\mathbb X+\lambda I)^{-1}\mathbb X^T\mathbb Y\)</span></p>
<h4 id="content">Content<a class="headerlink" href="#content" title="Permanent link">&para;</a></h4>
<p><mark>the estimator <span class="arithmatex">\(\hat\beta\)</span> of Ridge Regression, Ridge</mark>
<span class="arithmatex">\(\hat\beta_{\text{ridge}}= \min\limits_\beta\Vert \mathbb Y-\mathbb X\beta\Vert^2+\red{\lambda\Vert\beta\Vert^2}=(\mathbb X^T\mathbb X+\lambda I)^{-1}\mathbb X^T\mathbb Y,\quad \lambda&gt;0,\)</span></p>
<p><strong>Properties</strong> of ridge regression (assuming  <span class="arithmatex">\(\mathbb X\)</span> is nonrandom):</p>
<ol>
<li>a <strong>biased</strong> estimator, <span class="arithmatex">\(\begin{cases}\mathbb{E}\hat\beta_\text{ridge}=\beta-\lambda(\mathbb X^T\mathbb X+\lambda I)^{-1}\beta\\[1ex]\text{bias}(\hat\beta_\text{ridge})=-\lambda(\mathbb X^T\mathbb X+\lambda I)^{-1}\beta\end{cases}\)</span>
proof</li>
</ol>
<div class="arithmatex">\[\begin{align*}
\mathbb{E}\hat{\beta}&amp;=\mathbb{E}\Big\{(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\mathbb{Y}\Big\}\\
&amp;\xlongequal{\mathbb{Y}=\mathbb{X}\beta+\epsilon}\mathbb{E}\Big\{(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T(\mathbb{X}\beta+\epsilon)\Big\}\\
&amp;=\mathbb{E}\Big\{(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\mathbb{X}\beta\Big\}+\mathbb{E}\Big\{(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\epsilon\Big\}\\
&amp;=(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\mathbb{X}\beta+(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\mathbb{E}\epsilon\\
&amp;\xlongequal{\mathbb{E}\epsilon=0}(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\mathbb{X}\beta\\
&amp;\xlongequal{+1-1}(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}(\mathbb{X}^T\mathbb{X}+\lambda I)\beta-(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\lambda\beta\\
&amp;=\beta-(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\lambda\beta\neq\beta
\end{align*}\]</div>
<p><span class="arithmatex">\(bias=\red{\beta}-\mathbb{E}\hat{\beta}\)</span></p>
<p><span class="arithmatex">\(Var=\mathbb{E}(\red{\hat{\beta}}-\mathbb{E}\hat{\beta})^2\)</span></p>
<ol>
<li>Variance-covariance matrix
<span class="arithmatex">\(\text{if }Var(\mathcal{E})=\sigma^2I_n\implies Var(\hat\beta_\text{ridge})=(\mathbb X^T\mathbb X+\lambda I)^{-1}\mathbb X^T\mathbb X(\mathbb X^T\mathbb X+\lambda I)^{-1}\sigma^2\)</span>
proof</li>
</ol>
<div class="arithmatex">\[\begin{align*}
Var(\hat\beta_\text{ridge})&amp;=\mathbb{E}\Big\{(\hat{\beta}_\text{ridge}-\mathbb{E}\hat{\beta}_\text{ridge})^2\Big\}\\
&amp;=\mathbb{E}\Big\{\big((X^TX+\lambda I)^{-1}\mathbb{X}^T\mathbb{Y}-\mathbb{E}(X^TX+\lambda I)^{-1}\mathbb{X}^T\mathbb{Y}\big)^2\Big\}\\
&amp;\xlongequal[\mathbb{Y=X}\beta+\epsilon]{\mathbb{E\epsilon=0}}\mathbb{E}\Big[(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\epsilon\Big]^2\\
&amp;=\mathbb{E}\Big[(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\epsilon\epsilon^T\mathbb{X}(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\Big]\\
&amp;=(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\mathbb{E}\Big[\epsilon\epsilon^T\Big]\mathbb{X}(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\\
&amp;\xlongequal{Var(\epsilon)=\sigma^2I}\sigma^2\cdot(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}\mathbb{X}^T\mathbb{X}(\mathbb{X}^T\mathbb{X}+\lambda I)^{-1}
\end{align*}\]</div>
<h5 id="the-shrinkage-parameter-ridge">λ := the shrinkage parameter - ridge<a class="headerlink" href="#the-shrinkage-parameter-ridge" title="Permanent link">&para;</a></h5>
<ol>
<li><strong>controls</strong> the <strong>size</strong> of the coefficients, 它仅仅是调整参数的大小，并没有删去特征</li>
<li><strong>controls</strong> the amount of regularization
 <span class="arithmatex">\(\lambda \rightarrow \begin{cases}0&amp;\hat\beta_{ridge} =\hat\beta_{LSE}\\\infin&amp;\hat\beta_\text{ridge}=0\end{cases}，\qquad λ\uparrow, Bias\uparrow,Var(\beta_{ridge})\downarrow\)</span></li>
</ol>
<p>每一个  λ 可以求出一个 <span class="arithmatex">\(\hat\beta_{ridge} \iff\)</span> the solution is indexed by the parameter λ。
对每一个 lambda 我们都能 画出它的 <mark>solution path</mark>.  λs trace out <strong>a path of solutions</strong></p>
<div class="grid">
<figure><a class="glightbox" href="../pics/LRs_5.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_5.png" width="60%" /></a><p>coefficients paths</p></figure>
<p>右图是根据课上 centralized and standardized diabetes data 画出来的<br><span class="arithmatex">\(y=\beta_1x_1+\dots+\beta_{10}x_{10}+\epsilon\)</span><br>一共有10个 <span class="arithmatex">\(β_i\)</span>, 每一条线对应的是一个 <span class="arithmatex">\(β_i\)</span> <br>随着 λ 增大，logλ 增大，每一个 β 的绝对值都有不同程度的减少。当 λ 到达一个绝对大的值，所有的 β 都被收缩至 0.</p>
</div>
<div class="grid">
<figure><a class="glightbox" href="../pics/LRs_6.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_6.png" width="80%" /></a><p>coefficients paths</p></figure>
<p>Except for t = 0, in the other cases none of the coefficient is zero</p>
</div>
<p><span class="arithmatex">\(\beta^*[t]:=\min\limits_\beta \Vert\mathbb Y-\mathbb X\beta\Vert^2,\quad s.t.\space\Vert\beta\Vert^2\le t\)</span></p>
<div class="admonition p">
<p class="admonition-title">How to choose λ?  How to compare the different λ?</p>
<p><strong>a tuning parameter needs to be chosen</strong>. 作为人为设定的参数，它是可调参的</p>
</div>
<p><strong>via CV:</strong></p>
<p>We select a large range for possible <span class="arithmatex">\(λ\in [0, c]\)</span>. For each fixed λ in [0, c], consider the CV as follows. For each j,</p>
<p><span class="arithmatex">\(<span class="arithmatex">\(\hatβ_{ridge}^j(λ) = (\sum\limits_{i≠j} X_i^TX_i + λI)^{−1} \sum\limits_{i≠j} X_i^TY_i.\)</span>\)</span>
The prediction error for <span class="arithmatex">\((X_j ,Y_j)\)</span> is  <span class="arithmatex">\(err^j(\lambda)=(Y_j-X_j\hat\beta_{ridge}^j(\lambda))^2\)</span>
The CV value is then <span class="arithmatex">\(CV(\lambda)=n^{-1}\sum\limits_{j=1}^nerr^j(\lambda)\)</span>
<span class="arithmatex">\(\implies\lambda^* = \min\limits_{\lambda}CV(\lambda)\)</span></p>
<figure><a class="glightbox" href="../pics/LRs_6.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_6.png" width="60%" /></a><p>The best λ is the minimum point of CV(λ). </p></figure>
<h3 id="lasso-l1-penalty-least-absolute-shrinkage-and-selection-operator">Lasso - L1 penalty, Least Absolute Shrinkage and Selection Operator<a class="headerlink" href="#lasso-l1-penalty-least-absolute-shrinkage-and-selection-operator" title="Permanent link">&para;</a></h3>
<div class="admonition p">
<p class="admonition-title">这比估计所有确切值要容易得多，因为估计非常小的东西需要你需要很多信息，因为你必须增加样本量。否则，你无法正确估计一些弱信号，但一旦我们将3个信号定位为零，定位它们的位置就更容易了。我们确实牺牲了一些东西，</p>
</div>
<p><mark>L1- Norm</mark> <span class="arithmatex">\(\Vert w\Vert_1=(\sum\limits_{i=1}^d|x_i|)=|w|\)</span>
<mark>the estimator <span class="arithmatex">\(\hat\beta\)</span> of Lasso Regression, lasso</mark>
<span class="arithmatex">\(\hat\beta_{\text{lasso}}(\lambda):= \min\limits_\beta\sum\limits_{i=1}^n(\{Y_i-\sum\limits_{j=1}^pX_{ij}\beta_j\}^2+\lambda\red{\sum\limits_{j=1}^p|\beta_j|}=\min\limits_\beta\Vert Y-X\beta\Vert^2+\red{\lambda\Vert\beta\Vert_1}\\[1em]\qquad\hat\beta_{\text{lasso}}[\lambda]:= \min\limits_\beta\sum\limits_{i=1}^n(\{Y_i-\sum\limits_{j=1}^pX_{ij}\beta_j\}^2, \quad \red{\sum\limits_{j=1}^p|\beta_j|\le t}\iff \red{\Vert\beta\Vert_1\le t}\)</span></p>
<p>The two approaches are also <strong>equivalent</strong>:
<span class="arithmatex">\(<span class="arithmatex">\(\hat\beta_{lasso}[\Vert\hat\beta_{lasso}(\lambda)\Vert_1]=\hat\beta_{lasso}(\beta)\)</span>\)</span></p>
<p><mark>sparsity</mark>. Because of the nature of the constraint, with letting t sufficiently small (or λ sufficiently large),  Lasso will cause <strong>some of the coefficients to be exactly zero</strong>. 对 Lasso 来说，他确实在产生0，所以 <span class="arithmatex">\(\hat\beta_{lasso}\)</span> is sparse 稀疏的，那么这就可以进行 variable selection</p>
<div class="admonition question">
<p class="admonition-title">那如果在lasso之后把beta为0的特征值扔掉之后再LSE的准确率会一样吗？</p>
</div>
<h4 id="the-shrinkage-parameter-lasso">λ := the shrinkage parameter -lasso<a class="headerlink" href="#the-shrinkage-parameter-lasso" title="Permanent link">&para;</a></h4>
<p><mark>t</mark></p>
<ol>
<li>如果 t 足够大到 <span class="arithmatex">\(\sum\limits_{i=1}^p|{\hat\beta_{LSE}}_j|=\Vert\hat\beta_{LSE}\Vert_1=t_0\le t\implies\hat\beta_{lasso}=\hat\beta_{LSE}\)</span></li>
<li>如果 <span class="arithmatex">\(t = 0\implies \Vert\beta\Vert_1=0\implies\hat\beta_{lasso}=0\implies\)</span>no variable is selected</li>
<li><span class="arithmatex">\(s:= \cfrac{t}{t_0}=\cfrac{t}{\Vert\hat\beta_{LSE}\Vert_1}=\begin{cases}0\iff t = 0 \implies\text{no variables selected}\\1\iff t = t_0\implies\hat\beta_{lasso}=\hat\beta_{LSE}\end{cases}\)</span></li>
<li>it also inherits the properties of ridge regression and sometimes have more efficient estimator ——— exactly 0</li>
</ol>
<p><strong>with CV:</strong> Usually, 5-fold or 10-fold CV is used.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="n">mycv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cv.glmnet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="p">,</span><span class="w"> </span><span class="n">type.measure</span><span class="p">,</span><span class="w"> </span><span class="n">nfolds</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nf">plot</span><span class="p">(</span><span class="n">mycv</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="c1"># to plot the CV values against lambda</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">mylasso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">glmnet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">nlambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="o">=</span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="n">standardize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">intercept</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">standardize.response</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="nf">plot</span><span class="p">(</span><span class="n">mylasso</span><span class="p">)</span><span class="o">:</span><span class="w"> </span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="c1"># to plot the path of the estimated coefficients against t</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="n">mypred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">mylasso</span><span class="p">,</span><span class="w"> </span><span class="n">newx</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span>”<span class="n">link</span>”<span class="p">,</span>”<span class="n">response</span>”<span class="p">,</span><span class="w"> </span>”<span class="n">coefficients</span>”<span class="p">,</span>”<span class="n">nonzero</span>”<span class="p">,</span>”<span class="n">class</span>”<span class="p">))</span>
</code></pre></div></td></tr></table></div>
<p><code>mycv = cv.glmnet(x, y, lambda, type.measure, nfolds)</code></p>
<ul>
<li>input<ul>
<li>x: matrix of design of n×p</li>
<li>y: response y as in glmnet.</li>
<li>lambda=: Optional user-supplied lambda sequence; <strong>default is NULL, and glmnet chooses its own sequence</strong></li>
<li>nfolds=: number of folds - <strong>default is 10,</strong> nfolds=n is the delete-one-observation CV.</li>
</ul>
</li>
<li>output<ul>
<li><code>mycv$cvm</code>: the mean cross-validated error - a vector of length(lambda).</li>
<li><code>mycv$cvsd</code>: estimate of <code>the</code> standard error of cvm.</li>
<li><code>mycv$cvup</code>: upper curve = cvm+cvsd.</li>
<li><code>mycv$cvlo</code>: lower curve = cvm-cvsd.</li>
<li><code>mycv$nzero</code>: number of non-zero coefficients at each lambda.</li>
<li><code>mycv$lambda.min</code>: value of lambda that gives minimum cvm.</li>
<li><code>mycv$lambda.1se</code>: vlargest value of lambda such that error is within 1 standard error of the minimum.</li>
</ul>
</li>
</ul>
<p><code>mylasso = glmnet(x, y, family, alpha, nlambda = 100, lambda=NULL, standardize = TRUE, intercept=TRUE, standardize.response=FALSE)</code></p>
<ul>
<li>input<ul>
<li>x: input matrix, of dimension <span class="arithmatex">\(n\times p\)</span>; each row is an observation vector.</li>
<li>y: response variable.</li>
<li><code>family</code>: Response type, different generalized linear regression model<ul>
<li><code>gaussian</code> linear regression model</li>
<li>binomial”,”poisson”, ”multinomial”,”cox”,”mgaussian”)</li>
</ul>
</li>
<li><code>alpha</code>: The elasticnet mixing parameter, with 0 ≤ α ≤ 1. The penalty is defined as
<span class="arithmatex">\((1-\alpha)/2\Vert\beta\Vert_2+\alpha\Vert\beta\Vert_1\rightarrow\alpha = \begin{cases}1&amp;\text{ lasso(default)}\\0 &amp;\text{ ridge}\end{cases}\)</span></li>
<li><code>nlambda</code>: the number of lambda values - default is 100. 用来生成 solution path</li>
<li><code>lambda</code>: a user supplied lambda sequence.</li>
<li><code>standardize</code> = TRUE( default) / FALSE. Logical flag for X variable standardization, prior to fitting the model sequence. The coefficients are always returned on the original scale.</li>
<li><code>intercept</code>: Should intercept(s) be fitted (default=TRUE) or set to zero (FALSE)</li>
<li><code>dfmax</code>: Limit the maximum number of variables in the model. Useful for very large p, if a partial path is desired.</li>
</ul>
</li>
<li>output<ul>
<li>mylasso$a0: Intercept sequence of length length(lambda)</li>
<li>mylasso$beta: all the estimated β with different λs.</li>
<li>mylasso$lambda: The actual sequence of lambda values used</li>
<li>mylasso$df: The number of nonzero coefficients for each value of lambda.</li>
</ul>
</li>
</ul>
<p><code>mypred = predict(mylasso, newx, type=c(”link”,”response”, ”coefficients”,”nonzero”,”class”))</code></p>
<ul>
<li>mylasso: or any other name fitted ”glmnet” model object.</li>
<li>newx: Matrix of new values for x at which predictions are to be made.</li>
<li>type:<ul>
<li><code>link</code><ul>
<li>gives the linear predictors for ”binomial”, and ”multinomial” models;</li>
<li>for ” Gaussian” models it gives the fitted values.</li>
</ul>
</li>
<li><code>response</code> gives the fitted <strong>probabilities</strong> for ”binomial” or ”multinomial”;</li>
<li><code>class</code> applies only to ”binomial” or ”multinomial” models. for ”binomial” models, results are returned only for the class corresponding to the second level.</li>
</ul>
</li>
<li>Please state the procedure of selecting the tuning parameter based on 5-fold CV.</li>
</ul>
<h3 id="elastic-net-a-combination-of-lasso-and-ridge-regression">elastic net: A combination of Lasso and Ridge regression<a class="headerlink" href="#elastic-net-a-combination-of-lasso-and-ridge-regression" title="Permanent link">&para;</a></h3>
<p><mark>ridge</mark>. <span class="arithmatex">\(\hat\beta_{ridge}=\min\limits_\beta\sum\limits_{i=1}^n\{Y_i-\beta_1x_{i1}-\beta_2x_{i2}\}^2+\lambda\Vert\beta\Vert_2^2\)</span></p>
<p><mark>lasso</mark>. <span class="arithmatex">\(\hat\beta_{lasso} = \min\limits_\beta\sum\limits_{i=1}^n\{Y_i-\beta_1x_{i1}-\beta_2x_{i2}\}^2+\lambda\Vert\beta\Vert_1\)</span></p>
<p><mark>the elastic net estimator</mark>
<span class="arithmatex">\(\hat\beta_{net}:=\min\limits_\beta\sum\limits_{i=1}^n\{Y_i-\beta_1x_{i1}-\beta_2x_{i2}\}^2+\lambda\{(1-\alpha)\Vert\beta\Vert_2^2+\alpha\Vert\beta\Vert_1\},\alpha\in[0,1]\)</span></p>
<h2 id="comparison">Comparison<a class="headerlink" href="#comparison" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th>LSE</th>
<th>Ridge</th>
<th>Lasso</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="arithmatex">\(\mathbb{E}\)</span></td>
<td><span class="arithmatex">\(\beta\)</span></td>
<td><span class="arithmatex">\(\beta-\lambda(\mathbb X^T\mathbb X+\lambda I)^{-1}\beta\)</span></td>
<td>?</td>
</tr>
<tr>
<td>Bias</td>
<td>unbiased = 0 (smaller)</td>
<td>biased <span class="arithmatex">\(= -\lambda(\mathbb X^T\mathbb X+\lambda I)^{-1}\beta\)</span></td>
<td>?</td>
</tr>
<tr>
<td>Variance</td>
<td><span class="arithmatex">\((\mathbb X^T\mathbb X)^{-1}\sigma^2\)</span></td>
<td><span class="arithmatex">\((\mathbb X^T\mathbb X+\lambda I)^{-1}\mathbb X^T\mathbb X(\mathbb X^T\mathbb X+\lambda I)^{-1}\sigma^2\)</span> (smaller)</td>
<td>?</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Obviously, <span class="arithmatex">\(|\text{bias}(\hat\beta_\text{LSE})|\le|\text{bias}(\hat\beta_\text{ridge})|\)</span>, but <span class="arithmatex">\(Var(\hat\beta_\text{LSE})\ge Var(\hat\beta_\text{ridge})\)</span>. But how do we know which is better?</p>
</div>
<p><mark>Mean Squared Error, MSE</mark>. one of evaluations of an estimator of parameter:</p>
<div class="arithmatex">\[\begin{align*}MSE(\hat\mu)=\mathbb E\Vert \hat\mu-\mu\Vert^2&amp;=\mathbb E\{\red{(\hat\mu-\mu)^T(\hat\mu-\mu)_{\in\R}}\}\\&amp;=\mathbb Etr\{ \red{(\hat\mu-\mu)(\hat\mu-\mu)^T_{\in S^n}}\}\\&amp;=tr\{Var(\hat\mu)\}+\Vert Bias(\hat\mu)\Vert^2\\&amp;=tr\{Var(\hat\mu)\}+Bias(\hat\mu)^TBias(\hat\mu)\end{align*}\]</div>
<p><mark>Ridge &amp; LSE</mark>.  <span class="arithmatex">\(\exist\lambda\ge0,\text{ such that }\mathbb E \Vert\hat\beta_{\text{ridge}}- \beta\Vert^2\le\mathbb E\Vert\hat\beta_{\text{LSE}}-\beta\Vert^2\)</span>
一个理论支撑：是存在这么一个 lambda，所以只要我们选对 lambda， ridge 会比 LSE 要好.(指的是MSE更小)</p>
<ul>
<li>Case 1 If X is orthonormal, then  <span class="arithmatex">\(\mathbb X^T\mathbb X = I_p,\)</span>
<span class="arithmatex">\(\begin{cases}\hat\beta_{\text{ridge}}= (\mathbb X^T\mathbb X+\lambda I)^{-1}\mathbb X^T\mathbb Y= (1+\lambda)^{-1}\mathbb X^T\mathbb Y\\\hat\beta_{LSE}=\mathbb X^T \mathbb Y\end{cases}\implies \hat\beta_{ridge}=\cfrac{1}{1+\lambda}\hat\beta_{LSE}\)</span>
The optimal choice of λ minimizing <span class="arithmatex">\(\mathbb E\Vert\hat β_{ridge} − β\Vert^2\)</span> and the expected prediction error is:
<span class="arithmatex">\(\qquad\lambda^*=\min\limits_{\lambda}\mathbb E\Vert\hat β_{ridge} − β\Vert^2\\\qquad\qquad\implies \lambda^* = \cfrac{p\rho^2}{\sum\limits_{j=1}^p\beta_j^2}\)</span>
<span class="arithmatex">\((\beta_1,\dots,\beta_p):=\)</span> the true coefficient vector.
At this time  <span class="arithmatex">\(\mathbb E\Vert\hat β_{ridge} − β\Vert^2\red{&lt;} \mathbb E\Vert\hat β_{LSE} − β\Vert^2\)</span>.</li>
<li>Case 2  <span class="arithmatex">\(\mathbb X^T\mathbb X = nI_p,\)</span></li>
</ul>
<p>crease more bias but the variance is smaller iff more confident</p>
<h3 id="lse-lasso-ridge">LSE &amp; Lasso &amp; ridge<a class="headerlink" href="#lse-lasso-ridge" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../pics/LRs_7.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_7.png" width="40%" /></a></p>
<blockquote>
<blockquote>
<p>Consider a special case with <strong>1 variable</strong> and represent the problem。 <span class="arithmatex">\(Y_i=\beta x_i+\epsilon_i,i=1,\dots,n\)</span>
And assume that after centralized and scaled <span class="arithmatex">\(\iff\frac{1}{n}\sum\limits_{i=1}^nx_i = 0,\frac{1}{n}\sum\limits_{i=1}^nx_i^2=\mathbb X^T\mathbb X=1\)</span></p>
</blockquote>
<p><span class="arithmatex">\(\hat\beta_{LSE}=(\mathbb X^T\mathbb X)^{-1}\mathbb X^T\mathbb Y=\mathbb X^T\mathbb Y=\sum\limits_{i=1}^nx_iy_i\)</span></p>
<p><span class="arithmatex">\(\hat\beta_{ridge} = (\mathbb X^T\mathbb X+\lambda I)\mathbb X^T\mathbb Y=\cfrac{\hat\beta_{LSE}}{1+\lambda}=\cfrac{\sum\limits_{i=1}^nx_iy_i}{1+\lambda}\)</span></p>
<p><span class="arithmatex">\(\hat\beta_{lasso}=\min\limits_{\beta}\{Y_i-\beta x_i\}^2+\lambda |\beta|\xlongequal[\tilde\lambda=\lambda/2]{rewrite}\min\limits_{\beta}\{Y_i-\beta x_i\}^2+2\tilde\lambda |\beta|,\quad\lambda=2\tilde\lambda&gt;0\)</span></p>
<p><a class="glightbox" href="../pics/LRs_11.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_11.png" width="70%" /></a></p>
</blockquote>
<ul>
<li>Proof of Lasso.</li>
</ul>
<div class="arithmatex">\[\begin{align*}
\beta_\text{lasso}&amp;:=\min_\beta\Vert\mathbb{Y}-\mathbb{X}\beta\Vert^2+\lambda\Vert\beta\Vert_1\\
&amp;\xlongequal{1 \text{variable}} \min_\beta\sum_{i=1}^n(y_i-\beta x_i)^2+\lambda\vert\beta\vert\\
&amp;\xlongequal[\tilde{\lambda}=\lambda/2]{Rewrite}\min_\beta\sum_{i=1}^n(y_i-\beta x_i)^2+2\tilde{\lambda}\vert\beta\vert
\end{align*}\]</div>
<p>Take a derivate <span class="arithmatex">\(\cfrac{\partial f}{\partial\beta}\xlongequal{SET}0\)</span></p>
<div class="arithmatex">\[\begin{align*}
\frac{1}{2}\cdot\cfrac{\partial f}{\partial\beta}&amp;=-\sum_{i=1}^n(y_i-\beta x_i)x_i+\tilde{\lambda}\cfrac{\partial\vert\beta\vert}{\partial\beta}\\
&amp;=-\sum_{i=1}^nx_iy_i+\beta\sum_{i=1}^nx_i^2+\tilde{\lambda}\cfrac{\partial\vert\beta\vert}{\partial\beta}\\
&amp;\xlongequal{\sum\limits_{i=1}^nx_i^2=1}-\hat{\beta}_{LSE}+\beta+\tilde{\lambda}\cfrac{\partial\vert\beta\vert}{\partial\beta}=0
\end{align*}\]</div>
<ol>
<li>when 极值点存在于 <span class="arithmatex">\(\beta&gt;0\)</span>
<span class="arithmatex">\(\implies\hat{\beta}_{\text{lasso}}=\hat{\beta}_{LSE}-\tilde{\lambda}\)</span> exists when <span class="arithmatex">\(\hat{\beta}_{LSE}-\tilde{\lambda}&gt;0\)</span>
<span class="arithmatex">\(\frac{1}{2}\cdot\frac{\partial f}{\partial\beta}(\beta=0)=-\hat{\beta}_{LSE}&lt;0\)</span>
<span class="arithmatex">\(\frac{1}{2}\cdot\frac{\partial f}{\partial\beta}(\beta&lt;0)=-\hat{\beta}_{LSE}+\beta-\tilde{\lambda}&lt;-\hat{\beta}_{LSE}+0-\tilde{\lambda}&lt;0\)</span>
<span class="arithmatex">\(\implies\hat{\beta}_{\text{lasso}}=\hat{\beta}_{LSE}-\tilde{\lambda}\)</span> 是唯一一个极值点，开口向上，所是 <strong>global minimizer</strong></li>
<li>when 极值点存在于 <span class="arithmatex">\(\beta&lt;0\)</span>
<span class="arithmatex">\(\implies\hat{\beta}_{\text{lasso}}=\hat{\beta}_{LSE}+\tilde{\lambda}\)</span> exists when <span class="arithmatex">\(\hat{\beta}_{LSE}+\tilde{\lambda}&lt;0\)</span>
<span class="arithmatex">\(\frac{1}{2}\cdot\frac{\partial f}{\partial\beta}(\beta=0)=-\hat{\beta}_{LSE}&gt;0\)</span>
<span class="arithmatex">\(\frac{1}{2}\cdot\frac{\partial f}{\partial\beta}(\beta&gt;0)=-\hat{\beta}_{LSE}+\beta+\tilde{\lambda}&gt;-\hat{\beta}_{LSE}+0+\tilde{\lambda}&gt;0\)</span>
<span class="arithmatex">\(\implies\hat{\beta}_{\text{lasso}}=\hat{\beta}_{LSE}+\tilde{\lambda}\)</span> 是唯一一个极值点，开口向上，所是 <strong>global minimizer</strong></li>
<li>when 极值点存在于 <span class="arithmatex">\(\beta=0\)</span>
<span class="arithmatex">\(\implies\hat{\beta}_{\text{lasso}}=0\)</span> exists when
<span class="arithmatex">\(\frac{1}{2}\cdot\frac{\partial f}{\partial\beta}(\beta&gt;0)=-\hat{\beta}_{LSE}+\beta+\tilde{\lambda}&gt;0\)</span> always true when <span class="arithmatex">\(\hat{\beta}_{LSE}&lt;\tilde{\beta}\)</span>
<span class="arithmatex">\(\frac{1}{2}\cdot\frac{\partial f}{\partial\beta}(\beta&lt;0)=-\hat{\beta}_{LSE}+\beta-\tilde{\lambda}&lt;0\)</span> always true when <span class="arithmatex">\(\hat{\beta}_{LSE}&gt;-\tilde{\beta}\)</span>
<span class="arithmatex">\(\implies\hat{\beta}_{\text{lasso}}=\hat{\beta}_{LSE}=0\)</span> 是唯一一个极值点，开口向上，所是 <strong>global minimizer</strong></li>
</ol>
<div class="arithmatex">\[\hat{\beta}_\text{lasso}=\begin{cases}\hat{\beta}_\text{LSE}-\tilde{\lambda}&amp;0&lt;\tilde{\lambda}&lt;\hat{\beta}_\text{LSE}\\
0&amp;-\tilde{\lambda}&lt;\hat{\beta}_{LSE}&lt;\tilde{\lambda}\\
\hat{\beta}_\text{LSE}+\tilde{\lambda}&amp;\hat{\beta}_\text{LSE}&lt;-\tilde{\lambda}&lt;0\\
\end{cases}=\hat{\beta}_{LSE}+\text{sgn}(\hat{\beta}_{LSE})\tilde{\lambda}\]</div>
<p><u>shrinks big coeﬀicients by a constant <span class="arithmatex">\(\tilde{\lambda}=\frac{\lambda}{2}\)</span> towards zero.truncates small coeﬀicients to zero exactly</u></p>
<h3 id="lasso-ridge">Lasso &amp; ridge<a class="headerlink" href="#lasso-ridge" title="Permanent link">&para;</a></h3>
<p><strong>同是 shrinkage method，，但是在 penalty 项有所不同 (subtle but important differences)。</strong></p>
<p>Consider a case with 2 variables after centralized and scaled and represent the problem with a constraint format.</p>
<p><span class="arithmatex">\(\hat\beta_{ridge}=\min\limits_\beta\sum\limits_{i=1}^n\{Y_i-\beta_1x_{i1}-\beta_2x_{i2}\}^2,\quad s.t. \sum\limits_{j=1}^2\beta_j^2\le t\)</span></p>
<p><span class="arithmatex">\(\hat\beta_{lasso} = \min\limits_\beta\sum\limits_{i=1}^n\{Y_i-\beta_1x_{i1}-\beta_2x_{i2}\}^2,\quad s.t. \sum\limits_{j=1}^2|\beta_j|\le t\)</span></p>
<table>
<thead>
<tr>
<th></th>
<th>Ridge</th>
<th>Lasso</th>
</tr>
</thead>
<tbody>
<tr>
<td>constraint/penalty</td>
<td>平方</td>
<td>绝对值 absolute value</td>
</tr>
<tr>
<td>space</td>
<td>circle</td>
<td>square</td>
</tr>
<tr>
<td></td>
<td></td>
<td>稀疏解（最优解常出现在顶点上，且顶点上的 w 只有很少的元素是非零的）</td>
</tr>
<tr>
<td></td>
<td>凸函数，处处可微分</td>
<td>凸函数，不是处处可微分</td>
</tr>
</tbody>
</table>
<div class="grid">
<figure><a class="glightbox" href="../pics/LRs_8.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../pics/LRs_8.png" /></a><p>the lasso (left) and ridge regression (right)</p></figure>
<p>The solid blue areas are the constraint regions.<br>the red ellipses are the contours of the least squares error function</p>
</div>
<p><strong>Same:</strong>
很明显，它被迫限制 search in the constraint area
<strong>Difference:</strong></p>
<ol>
<li>他们都在 shrinkage in beta towards 0, 但 lasso creates zeros （这个 property is very attractive）</li>
</ol>
<h2 id="solution-path">solution path<a class="headerlink" href="#solution-path" title="Permanent link">&para;</a></h2>
<p>Notice that the solution is indexed by the parameter λ – So for each λ, we have a solution</p>
<p>当我们不指定 coefficient lambda 就会给我们生成 a lot of different lambda.
when Lambda is very small, whereby your estimate is close to least square. All coefficient was estimated shrink is towards 0, so the L1 norm becomes smaller and smaller and smaller
And and and the solution path is <strong>something like how different lambdas affects the solution and each line is actually estimated for for the corresponding feature.</strong></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 <a href="https://github.com/james-willett"  target="_blank" rel="noopener">Coconut</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/james-willett" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/TheJamesWillett" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/willettjames/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.annotation", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.081f42fc.min.js"></script>
      
        <script src="../../../javascripts/code_copy.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>